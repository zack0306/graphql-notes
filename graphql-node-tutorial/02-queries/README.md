# Queries
We will implement the resolver for the `feed` field
- List of links


## Define a `Link` type for the data model
First, replace the auto-generated `Post` type

Each link that gets stored in the database should have:
- Unique ID
- Description
- URL

In `./database/datamodel.graphql`, replace `Post` with:

```
type Link {
  id: ID! @unique
  description: String!
  url: String!
}
```


## Deploy the Database to Apply Changes
To deploy the Prisma database service:

```
yarn prisma deploy
```


## Adjust the Application Schema
CRUD operations are now supported
- Now, we need to update the application schema so that can used `feed` queries:

```
# import Link from "./generated/prisma.graphql"

type Query {
  feed(filter: String, skip: Int, first: Int): [Link!]!
}
```

- In this schema, we import `Link` from the Prisma schema
  - Importing is enabled by `graphql-import`


## Import the `feed` Resolver
Resolvers will be in `Query.js`, `Mutation.js`, and `Subscription.js`
- `index.js` will use these to instantiate the `GraphQLServer`
- We'll keep all resolvers in `./src/resolvers`
- The query:

```javascript
const feed = (parent, args, context, info) => {
  const { filter, first, skip } = args;
  const where = filter
    ? { OR: [{ urlContains: filter }, { descriptionContains: filter }] }
    : {};

  return context.db.query.links({ first, skip, where }, info);
};

export default feed;
```

  - The names of resolver functions must be identical to field names in `Query` types
  - Resolver arguments:
    - `parent` has the initial value for the resolver chain
      - This argument is used when resolving nested queries (for non-trivial cases)
      - If the client queries for a user's name and ID, the server must resolve:
        1. The user (`parent`)
        2. `parent.id`
        3. `parent.name`
    - `args` contains input arguments for the query, which are defined in the application schema
      - `filter` is used to build a filter object (`where`) to retrieve links that fit a certain criteria
    - `context` is an object that holds custom data while it's being passed through the resolver chain
    - `info` contains the AST of the query
      - Also has information about which part in the resolver chain is currently being executed
  - In the `return` statement, Prisma's `links` resolver is being used to retrieve the feed
- Now that the `feed` resolver is done, we must make sure it's used when the `GraphQLServer` is instantiated
  - In `index.js` we will put:

```javascript
const resolvers = {
  Query,
}
```


## Testing the GraphQL API
We will use `yarn run dev` in order to run the application on `localhost:4000`
- Visiting this URL will open a GraphQL Playground
- You can test interactions with your APIs here

There is no data stored yet, so we will send `createLink` mutations to the Primsa API
- This mutation was generated by Prisma earlier in the tutorial when we added the `Link` type

Now, we can use the `feed` query defined in the application schema:

```
{
  feed {
    description
    url
  }
}
```

- If we wanted to pass a filter:

```
{
  feed(filter: "cool") {
    description
    url
  }
}
```
